"use strict";(self.webpackChunkcanvas_docs=self.webpackChunkcanvas_docs||[]).push([[688],{3905:(e,n,a)=>{a.d(n,{Zo:()=>c,kt:()=>u});var t=a(7294);function i(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function r(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),a.push.apply(a,t)}return a}function o(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?r(Object(a),!0).forEach((function(n){i(e,n,a[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))}))}return e}function s(e,n){if(null==e)return{};var a,t,i=function(e,n){if(null==e)return{};var a,t,i={},r=Object.keys(e);for(t=0;t<r.length;t++)a=r[t],n.indexOf(a)>=0||(i[a]=e[a]);return i}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(t=0;t<r.length;t++)a=r[t],n.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}var p=t.createContext({}),l=function(e){var n=t.useContext(p),a=n;return e&&(a="function"==typeof e?e(n):o(o({},n),e)),a},c=function(e){var n=l(e.components);return t.createElement(p.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},m=t.forwardRef((function(e,n){var a=e.components,i=e.mdxType,r=e.originalType,p=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),m=l(a),u=i,h=m["".concat(p,".").concat(u)]||m[u]||d[u]||r;return a?t.createElement(h,o(o({ref:n},c),{},{components:a})):t.createElement(h,o({ref:n},c))}));function u(e,n){var a=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var r=a.length,o=new Array(r);o[0]=m;var s={};for(var p in n)hasOwnProperty.call(n,p)&&(s[p]=n[p]);s.originalType=e,s.mdxType="string"==typeof e?e:i,o[1]=s;for(var l=2;l<r;l++)o[l]=a[l];return t.createElement.apply(null,o)}return t.createElement.apply(null,a)}m.displayName="MDXCreateElement"},7565:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>p,contentTitle:()=>o,default:()=>d,frontMatter:()=>r,metadata:()=>s,toc:()=>l});var t=a(7462),i=(a(7294),a(3905));const r={},o="Canvas Command Line",s={unversionedId:"canvas/packages/cli/README",id:"canvas/packages/cli/README",title:"Canvas Command Line",description:"Canvas provides a command line interface for starting a node for any",source:"@site/docs/canvas/packages/cli/README.md",sourceDirName:"canvas/packages/cli",slug:"/canvas/packages/cli/",permalink:"/docs/canvas/packages/cli/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"sidebar",previous:{title:"Canvas React Hooks",permalink:"/docs/canvas/packages/hooks/"},next:{title:"@canvas-js/core",permalink:"/docs/canvas/packages/core/"}},p={},l=[{value:"<code>canvas run</code>",id:"canvas-run",level:2},{value:"Single-Core HTTP API",id:"single-core-http-api",level:2},{value:"Daemon HTTP API",id:"daemon-http-api",level:2}],c={toc:l};function d(e){let{components:n,...a}=e;return(0,i.kt)("wrapper",(0,t.Z)({},c,a,{components:n,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"canvas-command-line"},"Canvas Command Line"),(0,i.kt)("p",null,"Canvas provides a command line interface for starting a node for any\nCanvas contract. This is the primary and recommended way to run\napplications and join the peer-to-peer network."),(0,i.kt)("p",null,"To install the CLI, run:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"npm install -g @canvas-js/cli\n")),(0,i.kt)("p",null,"The CLI will run a Libp2p node, SQLite database, QuickJS VM for\nprocessing actions, and an API server. Use the ",(0,i.kt)("inlineCode",{parentName:"p"},"--help")," flag to learn more."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"canvas <command>\n\nCommands:\n  canvas init <filename>  Create a sample spec for demonstration purposes\n  canvas info <spec>      Show the models, views, and actions for a spec\n  canvas run <spec>       Run an app, by path or IPFS hash\n  canvas export <spec>    Export actions and sessions as JSON to stdout\n  canvas import <spec>    Import actions and sessions from stdin\n  canvas list             List all specs in the data directory\n  canvas install <spec>   Install an app in the canvas home directory\n  canvas daemon           Start the canvas daemon\n  canvas start <spec>     Start an app on the daemon\n  canvas stop <spec>      Stop an app on the daemon\n\nOptions:\n  --version  Show version number                                       [boolean]\n  --help     Show help                                                 [boolean]\n")),(0,i.kt)("h2",{id:"canvas-run"},(0,i.kt)("inlineCode",{parentName:"h2"},"canvas run")),(0,i.kt)("p",null,"To run a Canvas node, here are a few important options:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"--chain-rpc")," is used to provide the node with RPC URLs where it can get blockchain data. You should provide an RPC node for each unique chain ID that you want your contracts to support. The set of supported chains is automatically relayed to the frontend, so any React hooks can prompt the user to switch to the right chain."),(0,i.kt)("li",{parentName:"ul"},"Running an application by its filename will run it in development mode. To run an application in production mode, provide ",(0,i.kt)("inlineCode",{parentName:"li"},"--install")," or run it by providing its IPFS hash."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"--static")," can be used to serve static files alongside an application. This can be used to serve a Canvas frontend at the base URL ",(0,i.kt)("inlineCode",{parentName:"li"},"/")," which talks to APIs served under the ",(0,i.kt)("inlineCode",{parentName:"li"},"/api")," path.")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"canvas run <app>\n\nRun an app, by path or IPFS hash\n\nPositionals:\n  app  Path to app file, or IPFS hash of app                 [string] [required]\n\nOptions:\n  --version    Show version number                                     [boolean]\n  --help       Show help                                               [boolean]\n  --port       Port to bind the Core API                [number] [default: 8000]\n  --offline    Disable libp2p                         [boolean] [default: false]\n  --install    Install a local app and run it in production mode\n                                                      [boolean] [default: false]\n  --listen     Internal libp2p /ws multiaddr, e.g. /ip4/0.0.0.0/tcp/4444/ws\n                                                                         [array]\n  --announce   Public libp2p /ws multiaddr, e.g. /dns4/myapp.com/tcp/4444/ws\n                                                                         [array]\n  --reset      Reset the message log and model databases\n                                                      [boolean] [default: false]\n  --replay     Reconstruct the model database by replying the message log\n                                                      [boolean] [default: false]\n  --unchecked  Run the node in unchecked mode, without verifying block hashes\n                                                                       [boolean]\n  --metrics    Expose Prometheus endpoint at /metrics [boolean] [default: false]\n  --verbose    Enable verbose logging                 [boolean] [default: false]\n  --chain-rpc  Provide an RPC endpoint for reading on-chain data         [array]\n  --static     Serve a static directory from /, and API routes from /api[string]\n")),(0,i.kt)("h2",{id:"single-core-http-api"},"Single-Core HTTP API"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"$ canvas run <QmFoo...>\n")),(0,i.kt)("p",null,"Binds to ",(0,i.kt)("inlineCode",{parentName:"p"},"http://127.0.0.1:8000")," by default."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"GET /")," - get metadata about the application. Returns ",(0,i.kt)("inlineCode",{parentName:"li"},"{ uri: string; cid: string; actions: string[]; routes: string[] }"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"POST /actions")," - apply an action."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"POST /sessions")," - apply a session."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"GET /some/route/path")," - Get the value of a route, or open an server-sent event connection. Either returns a ",(0,i.kt)("inlineCode",{parentName:"li"},"text/event-stream")," or a ",(0,i.kt)("inlineCode",{parentName:"li"},"application/json")," array, depending on the requested ",(0,i.kt)("inlineCode",{parentName:"li"},"Accept")," header.")),(0,i.kt)("h2",{id:"daemon-http-api"},"Daemon HTTP API"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"$ canvas daemon\n")),(0,i.kt)("p",null,"Binds to ",(0,i.kt)("inlineCode",{parentName:"p"},"~/.canvas/daemon.sock"),". Pass a ",(0,i.kt)("inlineCode",{parentName:"p"},"--port")," argument to additionally bind to a port on ",(0,i.kt)("inlineCode",{parentName:"p"},"127.0.0.1"),"."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"GET /app")," - list the installed applications. Returns an object ",(0,i.kt)("inlineCode",{parentName:"li"},"Record<string, string>")," mapping app names to CIDs. For apps installed and run through normal CLI usage, these (app names and CIDs) will be the same."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"PUT /app/some-app-name")," - body must be a ",(0,i.kt)("inlineCode",{parentName:"li"},"Content-Type: text/javascript")," spec. Creates a new app with name ",(0,i.kt)("inlineCode",{parentName:"li"},"some-app-name")," and returns the hash in an ",(0,i.kt)("inlineCode",{parentName:"li"},"ETag")," response header. Does not start the app. Succeeds with status ",(0,i.kt)("inlineCode",{parentName:"li"},"OK"),", or fails with status ",(0,i.kt)("inlineCode",{parentName:"li"},"CONFLICT")," if an app with that name already exists."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"DELETE /app/some-app-name")," - permanently deletes the app with name ",(0,i.kt)("inlineCode",{parentName:"li"},"some-app-name"),", and all of its associated data. Succeeds with status ",(0,i.kt)("inlineCode",{parentName:"li"},"OK"),", or fails with status ",(0,i.kt)("inlineCode",{parentName:"li"},"NOT_FOUND")," if no app with that name already exists."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"POST /app/some-app-name/start")," - start the app with name ",(0,i.kt)("inlineCode",{parentName:"li"},"some-app-name"),". Succeeds with status ",(0,i.kt)("inlineCode",{parentName:"li"},"OK"),", fails with status ",(0,i.kt)("inlineCode",{parentName:"li"},"CONFLICT")," if the app is already running, or fails with status ",(0,i.kt)("inlineCode",{parentName:"li"},"NOT_FOUND")," if no app with that name already exists."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"POST /app/some-app-name/stop")," - stop the app with name ",(0,i.kt)("inlineCode",{parentName:"li"},"some-app-name"),". Succeeds with status ",(0,i.kt)("inlineCode",{parentName:"li"},"OK"),", or fails with status ",(0,i.kt)("inlineCode",{parentName:"li"},"CONFLICT")," if the app is not already running."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"GET /app/some-app-name")," - same as getting application metadata in the Core API. Returns ",(0,i.kt)("inlineCode",{parentName:"li"},"{ uri: string; cid: string; actions: string[]; routes: string[] }"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"POST /app/some-app-name/actions")," - same as action application in the Core API."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"POST /app/some-app-name/sessions")," - same as session application in the Core API."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"GET /app/some-app-name/some/route/path")," - same as fetching routes in the Core API. Either returns a ",(0,i.kt)("inlineCode",{parentName:"li"},"text/event-stream")," or a ",(0,i.kt)("inlineCode",{parentName:"li"},"application/json")," array, depending on the requested ",(0,i.kt)("inlineCode",{parentName:"li"},"Accpet")," header.")))}d.isMDXComponent=!0}}]);